#BCI 433 - IBMi Business Computing


Notes from following the snippets of the online course BCI 433 I could find.


## Programming Languages
* **Control Language (CL)** - Communication with the operating system. Similar concept to Unix shell.
* **Report Program Generator (RPG)** - How to access the database (DB2).
* **Data Description Specifications (DDS)** - How to define the database.
* **CMD** - The language used to write commands.


## CL Commands
* Libaries
  * ```CHGCURLIB BOLIB``` - Change current library
  * ```DSPLIB *CURLIB``` - Display current library
  * ```ADDLIBLE SOMELIB``` - Add a library to library list of **session**
* Files
  * ```CRTSRCPF``` - Create source physical file
  * ```WRKMBRPDM BOLIB/QCLSRC``` - Work with CL Source file
  * ```CRTCLPGM``` - Create CL Program
* PDM
  * ```WRKLIBPDM``` - Work with libraries
  * ```WRKOBJPDM``` - Work with objects
  * ```WRKMBRPDM``` - Work with members
* Misc
  * ```DSPMSG``` - Display messages
  * ```WRKSPLF``` - Work with spool files
  * ```WRKACTJOB``` - Shows all the jobs that are currently running and their status.


## Common Function Keys
* **F1** Help
* **F2** Extended Help
* **F3** Exit
* **F4** Prompt
* **F5** Refresh Screen
* **F9** Retrieve previous command
* **F12** Cancel
* **F23 (SHIFT+F11)** More options
* **F24 (SHIFT+F12)** More function keys


## SEU Editor Commands
* **I** - Insert a line
* **D** - Delete a line
* **C** - Copy a line
* **M** - Move a line
* **A** - Paste after
* **B** - Paste before
* **CC,CC** - Copy multiple lines
* **DD,DD** - Delete multiple lines
* **MM,MM** - Move multiple lines


## Jobs
* **Job** - Any and every piece of work on the AS/400.
* **Interactive Job** - Begins when user signs onto system, ends when signing off. Runs in subsystem **QINTER**
* **Batch Job** 
  * Runs in the background. 
  * Typically use a lot of resources and are low priority. 
  * Usually started by interactive jobs. 
  * Runs in subsystem **QBATCH**


## Queues
* A line up, where things wait.
* **Job queue** - Where batch jobs wait.
* **Message-queue** - Where messages wait.
* **Output-queue** - Where spool files wait to print.


## Objects
* **Objects** - Entities on the server that take up space, have a description, and are not considered temporary. Messages are not objects since they are read and then destroyed. 
* If no library is specified, an object is stored in **QGPL**.
* On iSeries, everything is an object; On Unix/Windows, everything is a file.
* On iSeries, objects have **types**. On Unix/Windows, files have extensions (.txt).
* Common object types: libraries, files, job queues, programs.


## Libaries and Library Lists
* **Libraries** 
  * Objects that store and index other objects.
  * Think of a directory in Unix/Windows
  * Cannot be subdivided into other libraries like folders/directories. 
  * Object type *LIB
* **Library List** - Subset lists of libraries.
  * The first part is made of libraries that the OS requires - System libraries (up to 15) (including QSYS).
  * The second part is dependent on any commands that are executed.
  * The third part is the default library specified by user profile.
  * The fourth part is libraries that are common between users. **QGPL** (Q General Purpose Library) and **QTEMP**.
* **QSYS** - Contains all objects necessary for running the server; It is the only library that can contain other libraries.
  * Stores **Library Descriptions** (Objects that store a library's address).
  * Also stores User Profiles and Device Descriptions.
* **QTEMP** - A temporary library that is created when a user signs on and deleted when signing off.
* **QSYSLIBL** - A system portion of library list containing IBM libraries and objects.
* **QUSRLIBL** - User portion of library list that contains libraries with commonly shared user objects.


## User Profiles
* A **user profile** is an object that stores user specific settings such as passwords, default output queue, and class of user.
* Some settings can override system values. For example, QLANGID controls the OS language and can be changed.
* General rule: If information is specific to you, it belongs in a user profile. If information is common to all, it belongs in a system value.
* User profiles are stored in QSYS.


## Files
* Objects that store data.
* A file is never run, it is read. Only programs are executed.
* DB2 is the database engine built into the OS.
* **Source Physical File**
  * An object used to store program code.
  * A source file can have many **members**.
  * Each separate program is a member of the source physical file.
  * When successfully compiled, a new *PGM object is placed in the current library.
  * All members have 3 fields: a line number, actual program code, and the date the line was entered/changed.


## Members
* A **Source physical file** is a container that stores **members**.
  * QCLLESRC -> physical file to store all CL programs.
  * QRPLESRC -> physical file to store all RPGLE programs.
* A **member** is a program, or group of records which is stored in a source physical file.


## CL Programming
* One pass compiled. 
* Start a CL program with ```PGM``` and end with ```ENDPGM```.
* Compilation
  * Source code ```{ QCLLESRC: { Members: [PGM1: *FILE], Type: CLLE } }```
  * CL Compiler
    * Successfully completed -> *MSGQ DSPMSG
  * Compiled Listing (PGM1) -> *OUTQ WRKSPLF
  * PGM1 *PGM


## RDp - Rational Developer for Power Systems
* Formerly RDi - Rational Developer for System i
* Based on Eclipse
* Part of the IBM Suite
* Essentially a PC version of PDM (Green screen)


## DB2 - The Database
* The IBMi's built-in database.
* Database objects are created using DDS programs or SQL.
* DB2 has **Physical files** (tables) and **Logical files** (indexes or views).


## DDS Programming (Data Description Specifications)
* DDS is used to define data.
* DDS is very sensitive, everything must be typed in uppercase.
* Structure
  * Start out with file level keywords/attributes that apply to the file.
  * **R**ecord format means a layout or a screen.
  * The fields are listed.
  * At end, the access path (**K**ey) information.
* (**R**: Record format name, **K**: Key field)
* Used for creating **physical files**, **logical files**, **display files**, **printer files**


## Display Files
* Source type **DSPF**
* Holds screen design - constants, literals, system constants(date, time, usr), named fields (RPG variables)



## Field Data Types
* **P** - Packed Decimal
* **S** - Zoned Decimal (If no decimal places, then none is assumed)
* **B** - Binary
* **F** - Floating Point
* **A** - Character (If data tyoe blank, character is assumed)
* **H** - Hexadecimal
* **L** - Date
* **T** - Time
* **Z** - TimeStamp


## RPG Syntax
* Indicators
  * ('0' or *OFF) | ('1' or *ON)
  *  *IN00 - *IN24 are used to map 24 function keys in display file
  *  *INLR - Last Record Indicator (End the RPG Program)
* Syntax
  * end statement ';'
  * comment '//'
  * conditionals '=', '<', '<=', '<>', 'NOT', 'AND', 'OR'
```RPG

// DO while
DOW (a <=5 ) AND (b + c = 0);
  EXSR nextRecord;
ENDDO;

// DO Until
DOU x > 10;
  Total = Total + Array(x);
  x = x + 1;
ENDDO;

// SELECT CASE
SELECT;
  WHEN condition;
    //do something
  OTHER;
    //do something else
ENDSL;

// Subroutines
EXSR GETGRADE

BEGSR GETGRADE;
  TOTALGRD = 90;
  LETGRADE = 'A+';
ENDSR;

*INLR = *ON; // Standard way of ending an RPG program
RETURN; // Return control to operating system
```



